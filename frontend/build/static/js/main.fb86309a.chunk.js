(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{14:function(t,e,n){},15:function(t,e,n){},17:function(t,e,n){"use strict";n.r(e);var i,a=n(0),o=n(1),s=n.n(o),r=n(7),l=n.n(r),c=(n(14),n(15),n(2)),h=n(3),p=n(5),u=n(4),v=n(8),f=function(){function t(e,n){Object(c.a)(this,t),this.name=void 0,this.relative_path=void 0,this.name=e,this.relative_path=n}return Object(h.a)(t,[{key:"getWavUrl",value:function(){return"http://localhost:5000/wav/".concat(this.relative_path)}}],[{key:"fromJson",value:function(e){return new t(e.name,e.relative_path)}}]),t}(),d=function(){function t(e,n){Object(c.a)(this,t),this.file_a=void 0,this.file_b=void 0,this.file_a=e,this.file_b=n}return Object(h.a)(t,null,[{key:"fromJson",value:function(e){return new t(f.fromJson(e.file_a),f.fromJson(e.file_b))}}]),t}();!function(t){t[t.A=0]="A",t[t.B=1]="B"}(i||(i={}));var m,b=function(t){Object(p.a)(n,t);var e=Object(u.a)(n);function n(t){var i;return Object(c.a)(this,n),(i=e.call(this,t)).state={},i}return Object(h.a)(n,[{key:"render",value:function(){var t=this,e=this.props.isPlaying?Object(a.jsx)("span",{className:"icon",children:"\ud83d\udd0a"}):Object(a.jsx)("span",{className:"icon",children:"\ud83d\udd08"}),n=this.props.isPlaying?"wav-file playing":"wav-file";return Object(a.jsxs)("div",{className:"experiment-option-container",children:[Object(a.jsxs)("div",{className:n,onClick:function(){return t.props.playCallback(t.props.experimentOption)},children:[e,Object(a.jsx)("div",{className:"filename",children:this.props.file.name})]}),Object(a.jsx)("button",{onClick:function(){return t.props.voteCallback(t.props.experimentOption)},children:"Vote"})]})}}]),n}(s.a.Component);!function(t){t[t.None=0]="None",t[t.OptionA=1]="OptionA",t[t.OptionB=2]="OptionB"}(m||(m={}));var y=function(t){Object(p.a)(n,t);var e=Object(u.a)(n);function n(t){var i;return Object(c.a)(this,n),(i=e.call(this,t)).state={playState:m.None,count:0,autoplay:!0},i}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var t=this;this.fetchStats().finally((function(){t.fetchNewExperiment()}))}},{key:"fetchStats",value:function(){var t=this;return fetch("http://localhost:5000/stats",{method:"GET"}).then((function(t){return t.json()})).then((function(e){var n=e.trial_count;void 0!==n&&t.setState({count:n})}))}},{key:"fetchNewExperiment",value:function(){var t=this;void 0!==this.state.howl&&(this.state.howl.stop(),this.setState({playState:m.None,howl:void 0}));fetch("http://localhost:5000/experiment",{method:"GET"}).then((function(t){return t.json()})).then((function(e){var n=d.fromJson(e);t.setState({experiment:n}),t.incrementCount(),t.handleAutoplay()}))}},{key:"handleAutoplay",value:function(){if(this.state.autoplay)switch(this.state.playState){case m.None:this.play(i.A);break;case m.OptionA:this.play(i.B);break;case m.OptionB:this.stop()}else this.stop()}},{key:"play",value:function(t){var e,n,a,o=this;void 0!==this.state.howl&&this.state.howl.stop();var s,r=m.None;switch(t){case i.A:a=null===(e=this.state.experiment)||void 0===e?void 0:e.file_a,r=m.OptionA;break;case i.B:a=null===(n=this.state.experiment)||void 0===n?void 0:n.file_b,r=m.OptionB}if(r===this.state.playState)r=m.None;else{var l=a.getWavUrl();(s=new v.Howl({src:[l],onend:function(){o.handleAutoplay()}})).play()}this.setState({playState:r,howl:s})}},{key:"vote",value:function(t){var e,n,a,o,s=this;this.stop();var r,l;switch(t){case i.A:r=null===(e=this.state.experiment)||void 0===e?void 0:e.file_a.relative_path,l=null===(n=this.state.experiment)||void 0===n?void 0:n.file_b.relative_path;break;case i.B:r=null===(a=this.state.experiment)||void 0===a?void 0:a.file_b.relative_path,l=null===(o=this.state.experiment)||void 0===o?void 0:o.file_a.relative_path}fetch("http://localhost:5000/vote",{method:"POST",headers:{Accept:"application/json","Content-type":"application/json"},body:JSON.stringify({winner:r,loser:l})}).then((function(t){s.fetchNewExperiment()}))}},{key:"stop",value:function(){void 0!==this.state.howl&&this.state.howl.stop(),this.setState({playState:m.None,howl:void 0})}},{key:"incrementCount",value:function(){this.setState({count:this.state.count+1})}},{key:"toggleAutoplay",value:function(){this.setState({autoplay:!this.state.autoplay})}},{key:"render",value:function(){var t;return t=void 0===this.state.experiment?this.renderEmpty():this.renderExperiment(),Object(a.jsx)("div",{children:t})}},{key:"renderEmpty",value:function(){return Object(a.jsx)("h1",{children:"Loading..."})}},{key:"renderExperiment",value:function(){var t=this,e="Turn autoplay ON";return this.state.autoplay&&(e="Turn autoplay OFF"),Object(a.jsxs)("div",{className:"experiment",children:[Object(a.jsxs)("h1",{children:["Trial ",this.state.count]}),Object(a.jsxs)("div",{className:"wav-experiment-container",children:[this.renderExperimentOption(i.A),this.renderExperimentOption(i.B)]}),Object(a.jsx)("button",{onClick:function(){return t.fetchNewExperiment()},children:"Skip"}),Object(a.jsx)("button",{onClick:function(){return t.toggleAutoplay()},children:e})]})}},{key:"renderExperimentOption",value:function(t){var e,n=!1;switch(t){case i.A:e=this.state.experiment.file_a,n=this.state.playState===m.OptionA;break;case i.B:e=this.state.experiment.file_b,n=this.state.playState===m.OptionB}return Object(a.jsx)(b,{file:e,isPlaying:n,experimentOption:t,playCallback:this.play.bind(this),voteCallback:this.vote.bind(this)})}}]),n}(s.a.Component);var j=function(){return Object(a.jsx)("div",{className:"main",children:Object(a.jsx)(y,{})})},O=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,18)).then((function(e){var n=e.getCLS,i=e.getFID,a=e.getFCP,o=e.getLCP,s=e.getTTFB;n(t),i(t),a(t),o(t),s(t)}))};l.a.render(Object(a.jsx)(s.a.StrictMode,{children:Object(a.jsx)(j,{})}),document.getElementById("root")),O()}},[[17,1,2]]]);
//# sourceMappingURL=main.fb86309a.chunk.js.map